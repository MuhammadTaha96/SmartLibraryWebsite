@model SmartLibraryWeb.ViewModel.BookViewModel

@{
    ViewBag.Title = "BookDetails";
    Layout = "~/Views/Shared/_Layout.cshtml";
    string reservationMessage = ViewData["resMessage"] != null ? ViewData["resMessage"].ToString() : string.Empty;
    string resMsgClass = bool.Parse(ViewData["reserved"] != null ? ViewData["reserved"].ToString() : "false") ? "success" : "error";
    string Authors = string.Empty;

    foreach (var author in Model.Authors)
    {
        Authors += author.Name + ",";
    }

    Authors = Authors.TrimEnd(',');    
    
}

@Html.HiddenFor(x => x.BookId)

<link href="~/Content/css/bookdetail.css" rel="stylesheet" />
<style>
    .bookCover {
        max-width: 217px;
        max-height: 346px;
        float: left;
        margin: 45px;
    }

    .navbar-nav {
        margin-top: 10px;
    }
</style>
<article>
    <div class="single-book-box">
        <div class="post-thumbnail">
            <img alt="Book"  src="@Model.ImagePath" />
        </div>
        <div class="post-detail">
            @*<div class="books-social-sharing">
                    <ul>
                        <li><a href="#" target="_blank"><i class="fa fa-facebook"></i></a></li>
                        <li><a href="#" target="_blank"><i class="fa fa-twitter"></i></a></li>
                        <li><a href="#" target="_blank"><i class="fa fa-google-plus"></i></a></li>
                        <li><a href="#" target="_blank"><i class="fa fa-rss"></i></a></li>
                        <li><a href="#" target="_blank"><i class="fa fa-linkedin"></i></a></li>
                    </ul>
                </div>*@
            @*<div class="optional-links">
                    <ul>
                        <li>
                            <a href="#" target="_blank" data-toggle="blog-tags" data-placement="top" title="Add TO CART">
                                <i class="fa fa-shopping-cart"></i>
                            </a>
                        </li>
                        <li>
                            <a href="#" target="_blank" data-toggle="blog-tags" data-placement="top" title="Like">
                                <i class="fa fa-heart"></i>
                            </a>
                        </li>
                        <li>
                            <a href="#" target="_blank" data-toggle="blog-tags" data-placement="top" title="Mail">
                                <i class="fa fa-envelope"></i>
                            </a>
                        </li>
                        <li>
                            <a href="#" target="_blank" data-toggle="blog-tags" data-placement="top" title="Search">
                                <i class="fa fa-search"></i>
                            </a>
                        </li>
                        <li>
                            <a href="#" target="_blank" data-toggle="blog-tags" data-placement="top" title="Print">
                                <i class="fa fa-print"></i>
                            </a>
                        </li>
                    </ul>
                </div>*@
            <header class="entry-header">
                <div class="row">
                    <div class="col-sm-6">
                        <h3 class="entry-title">
                            @Model.Title
                        </h3>
                        <ul>
                            <li><strong>Author(s):</strong> @Authors</li>
                            <li><strong>ISBN:</strong> @Model.ISBN_No</li>
                        </ul>
                    </div>
                    <div class="col-sm-6">
                        <ul>
                            <li><strong>Edition:</strong> @Model.Edition </li>
                            <li><strong>Local Availability:</strong> @Model.Copies.Where(x => x.Status.Name == "Available").Count() (of @Model.Copies.Count())</li>
                            <li><strong>Publisher:</strong> @Model.Publisher.Name (@Model.Publisher.Address)</li>
                        </ul>
                    </div>
                </div>
            </header>
            <div class="entry-content">
                <p>@Model.Description</p>
            </div>
            <footer class="entry-footer">
                @Html.ActionLink("Reserve", "Reserve", new { bookId = @Model.BookId }, new { @class = "btn btn-dark-gray", id = "btnReserve" })
                <span id="resMessage" class="@resMsgClass">@reservationMessage</span>
                <a class="btn btn-dark-gray right" id="btnComments" data-toggle="modal" data-target="#myModal" onclick="CallRenderComments(@Model.BookId)">Comments</a>
                <a class="btn btn-dark-gray right" id="btnComments" data-toggle="modal" data-target="#myModal" onclick="CallRenderReviews(@Model.BookId)">Reviews</a>
                <a class="btn btn-dark-gray right" id="btnComments" data-toggle="modal" data-target="#myModal" onclick="ShowBookLocation(@Model.BookId)">Location</a>

            </footer>
        </div>
        <div class="clear"></div>
    </div>
</article>

<p>
    @Html.ActionLink("Back to List", "GetAllBooks")
</p>
<!-- The Modal -->
<div class="modal" id="myModal">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">

            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title">Modal Heading</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>

            <!-- Modal body -->
            <div class="modal-body" id="modal-data">
            </div>

            <!-- Modal footer -->
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
            </div>

        </div>
    </div>
</div>
<script>
    $(document).ready(function () {
        if (@Model.Copies.Where(x=>x.Status.StatusId == 1).Count() == 0)
        {
            $('#btnReserve').attr('disabled', 'disabled');
            debugger;
            if("@resMsgClass" != "success" )
                $('#btnReserve').text('No copies available right now');
        }
    })
</script>